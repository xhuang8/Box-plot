<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <!--load d3.js-->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="box.js"></script>

    <!-- title for d3 -->
    <title>Data set for trading</title>

    <!--css style-->
    <style>

        /* body attributes */
        body {
            margin: 0;
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        /* text attributes */
        text {
            font-family: "Helvetica Neue";
            color: black;
            font-size: 1.2px;

        }

        /* box plot */
        .box {
            font: 10px sans-serif;
        }

        .box line,
        .box rect,
        .box circle {
            fill: cadetblue;
            stroke: black;
            stroke-width: 1.5px;
        }

        .box .center {
            stroke-dasharray: 2,3;
        }

        .box .outlier {
            fill: none;
            stroke: black;
        }

        /* axis attributes */
        .axis {
            font: 12px "Helvetica Neue";
        }

        .axis path,
        .axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }

        .x.axis path,
        .x.axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }

        .y.axis path,
        .y.axis line {
            fill: none;
            stroke: black;
            shape-rendering: crispEdges;
        }
    </style>
</head>


<body>
<div id="data"></div>
<script>

    //set the size and color for the chart
    var totalWidth = 800;
    var totalHeight = 500;
    // var labels = true;

    //set the dimensions and margins of the graph
    var margin  = {top: 40, right: 30, bottom: 30, left: 50},
        width = totalWidth - margin.left - margin.right,
        height = totalHeight - margin.top - margin.bottom;

    var barWidth = 40;
    var boxPlotColor = "blue";
    var medianLineColor = "black";
    var axisColor = "grey";

    //var min = Infinity,
    //    max = -Infinity;

    <!--
    /append the svg object to the body of the page
    var svg = d3.select("#my_box")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
    -->

    //setup the svg to draw the box plot into
    var svg = d3.select("body").append("svg")
        .attr("width", totalWidth)
        .attr("height", totalHeight)
        .attr("g")
        .attr("transform", "translate(" + (margin.left - barWidth) + "," + margin.top + ")");

    //initial the box
    var chart = d3.box()
        .whiskers(tenths(1.5))
        .width(width)
        .height(height);

    //parse the date with the format %Y%m%d
    var parseDate = d3.time.format("%Y%m%d").parse;

    //X axis
    var x = d3.time.scale()
        .range([0, width]);

    var xAxis = d3.axisBottom()
        .scale(x)
        .tickSize(-height)

    //Y axis
    var y = d3.scaleLinear()
        .range([height, 0]);

    var yAxis = d3.axisLeft()
        .scale(y)
        .tickSize(-width);

    //svg file
    var svg = d3.select("body").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    //read and parse data for csv file
    //to draw the box, we have to use the some information which like quartiles, median, inter quartile range min and max
    d3.csv("data.csv", function (error, csv) {
       // if(error) {
         //   console.log(error);
        //}
       // console.log(csv);
        var data = [];
        //csv is kind like array, using the array with data [i][2] to match with csv file
       // data[1] = [];
       // data[2] = [];
       // data[3] = [];
       // data[4] = [];
       // data[5] = [];
        //data[6] = [];
        //it shows the data in the ith column in the csv file
        //showing the header of the csv file
        //data[1][0] = "open";
        //data[2][0] = "high";
        //data[3][0] = "low";
        //data[4][0] = "close";
        //data[5][0] = "adj_close";
        //data[6][0] = "volume";
        //data[1][1] = [];
        //data[2][1] = [];
        //data[3][1] = [];
        //data[4][1] = [];
        //data[5][1] = [];
        //data[6][1] = [];

        csv.forEach(function (x) {

            var e = Math.floor(x.date - 1),
               // r = Math.floor(x.year - 1),
                s = Math.floor(x.mean),
                d = data[e];

            if (!d)
                d = data[e] = [s];
            else
                d.push(s);
            if (s > max)
                max = s;
            if (s < min)
                min = s;

           // var v1 = Math.floor(x.open),
             //   v2 = Math.floor(x.high),
              //  v3 = Math.floor(x.low),
               // v4 = Math.floor(x.close),
               // v5 = Math.floor(x.adj_close),
               // v6 = Math.floor(x.volume);
            //arr = [v1, v2, v3, v4, v5, v6]
            //var rowMax = Math.max(v1, v2, v3, v4, v5, v6);
            //var rowMin = Math.min(v1, v2, v3, v4, v5, v6);
            //data[1][1].push(v1);
            //data[2][1].push(v2);
            //data[3][1].push(v3);
            //data[4][1].push(v4);
            //data[5][1].push(v5);
            //data[6][1].push(v6);
            //if(rowMax > max)
              //  max = rowMax;
            //if(rowMin < min)
              //  min = rowMin;
            //max values
            //max = 10000000;
            console.log(data);
        });


        chart.domain([min, max]);
        x.domain([parseDate(new Date().getFullYear()+"0101"),parseDate(((new Date().getFullYear()))+"1231")]);
        y.domain([min, max]);

            //initial the box plot
           // var chart = d3.box()
             //   .whiskers(iqr(1.5))
               // .height(height)
               // .domain([min, max])
               // .showLabels(labels);

          //  var svg = d3.select("body").append("svg")
            //    .attr("width", width + margin.left + margin.right)
             //   .attr("height", height + margin.top + margin.bottom)
              //  .attr("class", "box")
             //   .append("g")
              //  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");



            //define x-axis
          //  var x = d3.scaleOrdinal()
            //    .domain(data.map(function (d) {
              //      return d[1]
               // }))
               // .rangeRound([0, width]);

            //var xAxis = d3.axisBottom()
              //  .scale(x);



            //define y-axis
           // var y = d3.scaleLinear()
             //   .domain([min, max])
              //  .range([height + margin.top, 0 + margin.top]);

            //var yAxis = d3.axisLeft()
            //    .scale(y);



            //draw the box plots
            svg.selectAll(".box")
                .data(data)
                //.data(data)
                .enter().append("svg")
                .attr("class", "box")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.bottom + margin.top)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
                .call(chart);

        xAxis.ticks(d3.time.months, 1)
            .tickFormat(d3.time.format("%b"));

            //adding the title for box-plot
            //svg.append("text")
              //  .attr("x", (width/2))
               // .attr("y", 0 + (margin.top/2))
               // .attr("text-anchor", "middle")
                //.style("font-size", "18px")
                //.text("Data set for trading in 2019");

            //draw y axis
            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis)
                .selectAll("text")
                .attr("y", 6)
                .attr("x", 15)
                .style("text-anchor", "middle");

            //draw x axis
            svg.append("g")
                .attr("class", "y axis")
                .call(yAxis)
                .append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 6)
                .attr("dy", ".71em")
                .attr("x", -6)
                .style("text-anchor", "end")
                .text("");
    });

    function tenths() {
        return function(d, i) {
            var q1 = d3.quantile(d, .1),
                q9 = d3.quantile(d, .9),
                i = -1,
                j = d.length;
            while (d[++i] < q1);
            while (d[--j] > q9);
            return [i, j];
        };
    }

</script>

</body>
</html>